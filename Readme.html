<html>
	<head>
		<style>
			html {
			background-color: #000207;
			color: white;
			font-family: sans-serif;
			}
			
			table, th, td {
			border: 1px solid white;
			border-collapse: collapse;
			}
			
			span.NoLineBreak {
				white-space: nowrap;
			}
			
			abbr{cursor: help;}
			img.img-hor {
				-moz-transform: scaleX(-1);
				-o-transform: scaleX(-1);
				-webkit-transform: scaleX(-1);
				transform: scaleX(-1);
				filter: FlipH;
				-ms-filter: "FlipH";
			}
		</style>
	</head>
<body>
<center><h1>Custom scroll limits</h1></center>
<h2>Introduction</h2>
<p>This ASM package enables you to set custom boundaries of your level</p>

<p>Normally, you would think this is redundant because there exist other codes that stops the screen scrolling at a certain XY position, say one
found in the <a href="https://www.smwcentral.net/?p=viewthread&t=62286">ASM library</a>, however this ASM package offers more flexibility, and that
you can have &ldquo;multiple scroll stops&rdquo; without duplicate code</p>
<h2>Note before use</h2>
<ul>
	<li>This patch obviously will hijack scrolling related codes (<kbd>$00F73C</kbd> (horizontal level limits for left and right borders), <kbd>$00F893</kbd>
	(horizontal and vertical limits for top and bottom borders)). If you wish to have other scrolling-related patches such as my <a href="https://www.smwcentral.net/?p=section&a=details&id=26861">Center scroll patch</a>
	or <a href="https://www.smwcentral.net/?p=section&a=details&id=17737">Vertical Camera Panning</a>. In these cases, you'll need to merge the ASM files (more specifically, not to use SMW's default scroll limits but
	use this custom scroll limits patch's RAM that controls the limits)</li>
	<li>SMW's horizontal scrolling is instant-- that it simply takes Mario's X position, take various calculations handled at <kbd>$00F73C</kbd> (which also handles the left and right limits), unlike vertical scrolling,
	which that is handled at <kbd>$00F88F</kbd>, horizontal scrolling <b>instantly</b> sets the screen X position within the level rather than gradually incrementing/decrementing it. So these situations should be avoided that causes
	layer 1 graphic glitches due to not giving it frames to load the columns of 16x16 tiles:
		<ul>
			<li>Teleporting the player, as in taking the player's X position (<kbd>$94</kbd>), add or subtract by some large number that results the player being &ldquo;teleported&rdquo; in long distances.</li>
			<li>Have horizontal scrolling disabled (<kbd>$1411</kbd> set to $00), then enable horizontal scrolling while the player is outside the static camera region. This will cause the camera to jump to be centered
			with the player</li>
		</ul>
	
	</li>
	<li>RAM address <kbd>$13F2</kbd> is no longer cleared by <kbd>$00F8A7</kbd>.</li>
	<li>Anytime you want to trigger a &ldquo;<abbr title="The effect you see in Megaman games, areas separated by scroll limits that the screen will not go past unless the player triggers something like opening a door or touching the edge of an area">flip screen</abbr>&rdquo;
	effect, I <b>highly</b> recommend setting <kbd>$1411</kbd> and <kbd>$1412</kbd> to zero (disable horizontal and vertical scrolling). Even though uberasm tool already
	STZs it, if you don't disable horizontal scrolling and your code is executed, then runs <kbd>$00F70D</kbd> or <kbd>$00F75C</kbd>, before executing uberasm tool's gamemode 14, screen-jumping (screen changes position instantly
	and result graphical glitches) can still occur</li>
	<li>Setting <kbd>$1411</kbd> and <kbd>$1412</kbd> only disables the default scrolling (the behavior of the screen to follow the player) as well as the scrolling limit not to go left past the screen $00 or go right past the last
	screen. Autoscroll generators have done this.</li>
</ul>
<h2>Required patches</h2>
<ul>
	<li><a href="https://www.smwcentral.net/?p=section&a=details&id=13675">Sprite scroll fix</a>: The system to check which scroll direction sprites should be able to spawn (<kbd>$55</kbd>/<kbd>$56</kbd>) is flawed, that it
	check which side the player is located relative to the &ldquo;static camera region&rdquo; (<kbd>$142A</kbd>), rather than the actual scrolling of the screen.</li>
</ul>
<h2>Recommended patches</h2>
<ul>
	<li><a href="https://www.smwcentral.net/?p=section&a=details&id=14978">Disable Screen Barrier via RAM</a>: Useful if you want such triggers that would trigger the flip-screen effect by touching the very edges of the screen, and also
	prevent potential deaths caused by being at those edges of the screen.</li>
</ul>
<h2>Interesting facts</h2>
<ul>
	<li>When horizontal and/or vertical scrolling are disabled (<kbd>$1411</kbd> and/or <kbd>$1412</kbd>), the boundaries (left or right for horizontal, top and bottom for vertical) are no longer running (it will not set the XY coordinate of
	the screen to place it back in bounds).</li>
</ul>
<h2>Installation</h2>
	<ol>
		<li>Defines</li>
		<ol>
			<li>Open <kbd>SMW-Scroll-limits/ScrollLimitsDefines/Defines.asm</kbd>, and make any necessary changes on it. There is a very high chance you'll need to do this if you have other ASM resources that uses freeram as well, as they
			tend to &ldquo;overlap&rdquo; with the default RAMs the patch provided here uses.</li>
		</ol>
		<li>Patches</li>
		<ol>
			<li>Before you patch <kbd>ScrollLimitsPatch.asm</kbd> or other patches related to scrolling, open <kbd>ScrollLimitsPatch.asm</kbd> AND the other patches (specifically if they hijack scrolling-related code) and see the
			<kbd>org $xxxxxx</kbd> would conflict. If they do, you'll need to merge them and potentially need to learn a little bit of ASM.<br><br>
			
			<kbd>ScrollLimitsPatch.asm</kbd> just modifies the behavior how scrolling limits work. If you say, install my &ldquo;Center Scroll&rdquo; patch, for example, edit the center scroll patch's scroll limits so that it first checks
			the RAM defined by <kbd>!Freeram_ScrollLimitsFlag</kbd>, and if it is nonzero, then it should do something similar how the patch provided here works.</li>
		</ol>
		<li>Uberasm tool (installs the flip screen effect)</li>
		<ol>
			<li>In <kbd>SMW-Scroll-limits/UberasmTool/</kbd>, place the files in their appropriate spots in uberasm tool's files. They are conveniently named.</li>
			<li>Run the tool</li>
		</ol>
	</ol>
<h2>Getting started</h2>
	<p>With these installed (properly) you can now set your own borders. Keep these information in mind:</p>
	<ul>
		<li><font color="grey">Grey</font> means outside the level boundaries</li>
		<li><font color="blue">blue</font> means inside the level boundaries</li>
		<li><font color="cyan">cyan</font> means the game screen</li>
		<li><font color="#800000">red</font> means the boundaries specified by the RAM the patch uses</li>
		<li><font color="orange">orange</font> means the actual scrolling stopping position for the bottom and right borders</li>
	</ul>
	<ul>
		<li>Origin positions:<br>
		<img src="readme_files/LevelAndGameScreen.png"><br>
		Almost everything have their origin point on their top-left corner.</li>
		<li>How the right and bottom borders are placed, relative to the origin position of the scroll limits box:<br>
		<img src="readme_files/ScrollLimitsBox.png"></li>
		<li>Where the screen will stop at relative to the border:<br>
		<img src="readme_files/LeftAndTop.png"><br>
		Pretty obvious, but for bottom and right borders, they take the screen's origin position to limit instead of the right and bottom edge of the screen:<br>
		<img src="readme_files/RightAndBottom.png"><br>
		Therefore, if you want to get the width/height of an area, and that is the actual rather than where the top-left corner of the screen to stop at, you would do this formula to write to <kbd>!Freeram_ScrollLimitsAreaWidth</kbd>
		and <kbd>!Freeram_ScrollLimitsAreaHeight</kbd>:
		<ul>
			<li><kbd>WidthForFreeramYouShouldUse = PercievedWidth - 256</kbd></li>
			<li><kbd>HeightForFreeramYouShouldUse = PercievedHeight - 224</kbd></li>
		</ul><br>
		And to get the <kbd>PercievedWidth</kbd> and <kbd>PercievedHeight</kbd>, just use Lunar Magic, hover your mouse to anywhere you want to place your borders to be on, take the coordinates on the bottom left corner (it shows the coordinate
		in blocks, multiply by 16).
		</li>
	</ul>
